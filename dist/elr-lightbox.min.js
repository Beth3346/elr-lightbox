!function($){window.elrLightbox=function(params){var self={},spec=params||{},$images=spec.images||$("ul.elr-lightbox-thumbnails"),speed=spec.speed||300,createThumbnails=function(list){var $links=list.find("a"),thumbnailList=[],thumbnails="";return $links.each(function(){thumbnailList.push($(this).attr("href"))}),$.each(thumbnailList,function(k,v){thumbnails+="<li><a href="+v+"><img src="+v+" /></a></li>"}),thumbnails},createLightbox=function(thumbnails,speed){var img=$(this).attr("href"),$imgVisible=elr.createElement("img",{"class":"img-visible",src:img,alt:"thumbnail"}),$close=elr.createElement("button",{"class":"close",text:"x"}),$thumbnails=elr.createElement("ul",{"class":"thumbnail-list",html:thumbnails}),$nav=elr.createElement("div",{"class":"lightbox-nav",html:'<button class="prev" data-dir="prev"><i class="fa fa-caret-left"></i></button><button class="next" data-dir="next"><i class="fa fa-caret-right"></i></button>'}),$lightbox=elr.createElement("div",{"class":"elr-blackout"});$lightbox.hide().appendTo("body").fadeIn(speed,function(){$close.appendTo($lightbox),$imgVisible.appendTo($lightbox),$nav.appendTo($lightbox),$thumbnails.appendTo($lightbox)})},advanceImage=function(direction){var $nextImg,nextImgIndex,$list=$(".thumbnail-list"),$currentImg=$("div.elr-blackout img.img-visible"),currentImgSrc=$currentImg.attr("src"),$currentThumb=$list.find('img[src$="'+currentImgSrc+'"]').closest("li").index(),len=$list.find("li").length-1;nextImgIndex="prev"===direction?0===$currentThumb?len:$currentThumb-1:$currentThumb===len?0:$currentThumb+1,$nextImg=$list.find("li").eq(nextImgIndex).find("img").attr("src"),$currentImg.fadeOut(speed,function(){$(this).attr("src",$nextImg).fadeIn(speed)})},changeImage=function(){var img=$(this).attr("href"),$oldImg=$("div.elr-blackout img.img-visible"),oldImgSrc=$oldImg.attr("src");oldImgSrc!==img&&$oldImg.fadeOut(speed,function(){$(this).attr("src",img).fadeIn(speed)})},removeLightbox=function(){$("div.elr-blackout").fadeOut(speed,function(){$(this).remove()})};if($images.length){var thumbnails=createThumbnails($images),$body=$("body");$images.on("click","a",function(e){e.preventDefault(),createLightbox.call(this,thumbnails,speed)}),$body.on("click","div.elr-blackout button.close",removeLightbox),$body.on("click","div.elr-blackout",function(e){removeLightbox(),e.stopPropagation()}),$body.on("click","div.elr-blackout ul.thumbnail-list a",function(e){e.preventDefault(),e.stopPropagation(),changeImage.call(this)}),elr.killEvent($body,"click","div.elr-blackout .img-visible"),elr.killEvent($body,"click","div.elr-blackout .lightbox-nav"),$body.on("click","div.elr-blackout .lightbox-nav button",function(e){var direction=$(this).data("dir");e.preventDefault(),e.stopPropagation(),advanceImage(direction)}),$body.on("keydown",function(e){37===e.which?advanceImage("prev"):39===e.which&&advanceImage("next")})}return self}}(jQuery);